<style>
        body, input, button, select, textarea, code, kbd, pre, samp {
            font-family: 'Open Sans', sans-serif;
		background-color: #000;
		color: #ccc;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Open Sans', sans-serif;
            font-weight: 900;
        }

        h1 {
            margin-left: 30px;
        }
        .bwp-syntax-block.clearfix{
            width: 75%;
        }
		
		pre {
		background-color: #222;
		color: #fff;
		margin-left: 10%;
		padding: 10px 3%;
		width: 50%;
        
		}
    </style>

<h1>
Event Overview
</h1>
The Hybris Event Framework is a powerful and flexible mechanism within SAP Hybris Commerce that allows developers to manage and trigger events in response to various actions or conditions. These events can be used to extend and customize the platform's functionality to meet specific business requirements.
</p><p>
Events are a common way of communicating between software components. Sources emit events and each party registers listeners that can receive those events and execute logic.
</p><p>
Here's an overview of the key aspects of the Hybris Event Framework:
</p><p>
1) Event Types:
</p><p>
System Events: These are predefined events generated by the Hybris platform in response to certain system-level actions, like object creation, modification, or deletion.
</p><p>
Custom Events: Developers can define custom events tailored to their specific needs. These events can be triggered from within custom extensions or other parts of the system.
</p><p>
2) Listeners:
</p><p>
Event Listeners: These are components or services that subscribe to specific events. When an event occurs, all registered listeners for that event are notified, allowing them to respond accordingly.
</p><p>
Listeners Types: Listeners can be implemented as Spring beans or as AspectJ aspects, offering flexibility in how event handling logic is structured.
</p><p>

3) Event Publishing:
</p><p>

Events are typically published within code using the Hybris Event Service. Developers can specify the event type and any necessary data to include with the event.
</p><p>

Events can also be triggered by system actions, such as when a certain object is saved or when specific business processes are executed.

</p><p>
 
4) Event Handling:
</p><p>

Event listeners are responsible for defining the logic that should be executed when a particular event occurs. This can include updating data, triggering other processes, or sending notifications.
</p><p>

Event handling can be synchronous or asynchronous, depending on the use case. Asynchronous handling can be useful for offloading time-consuming tasks from the main application thread.
</p><p>


Event Creation Steps
</p><p>

We have divided the event creation steps in following 4 parts. 
</p><p>

1) Create a Custom Event Type: In your Hybris extension, you'll first define a custom event type. This involves creating a Java class that extends AbstractEvent.
</p><pre>

package com.hybris.learn.events;

import de.hybris.platform.servicelayer.event.events.AbstractEvent;

public class ProductAddedEvent extends AbstractEvent {

    private final String productName;

    public ProductAddedEvent(final Object source, final String productName) {

        super(source);

        this.productName = productName;

    }

    public String getProductName() {

        return productName;

    }

}
</pre><p>


2) Create an Event Listener:  You'll create an event listener that will respond to the custom event. Event listeners can be implemented as Spring beans. Here's a simple listener that logs a message when a product is added:
</p><pre>

package com.yourcompany.listeners;

import de.hybris.platform.servicelayer.event.impl.AbstractEventListener;

import com.yourcompany.events.ProductAddedEvent;

public class ProductAddedEventListener extends AbstractEventListener<ProductAddedEvent> {

    @Override

    protected void onEvent(final ProductAddedEvent event) {

        String productName = event.getProductName();

        System.out.println("New product added: " + productName);

        // You can perform additional actions here, such as sending notifications.

    }

}
</pre><p>


3) Configure the Event Listener: In your Spring configuration file, you'll configure the event listener as a Spring bean.

​</p><p>


​<bean id="productAddedEventListener" class="com.yourcompany.listeners.ProductAddedEventListener" parent="abstractEventListener"/bean>

​​</p><p>


4) Trigger the Custom Event: Finally, you can trigger the custom event when a new product is added to the system. Here's an example in a hypothetical service:
</p><pre>


package com.yourcompany.services;

import com.yourcompany.events.ProductAddedEvent;

import de.hybris.platform.servicelayer.event.EventService;

public class ProductService {

    private EventService eventService;

    public void addProduct(String productName) {

        // Logic to add the product

        // Trigger the custom event

        ProductAddedEvent productEvent = new ProductAddedEvent(this, productName);

        eventService.publishEvent(productEvent);

    }

    // Other methods and dependencies

}
</pre><p>
As discussed, when the addProduct method is called, a ProductAddedEvent will be triggered, and the ProductAddedEventListener will respond by logging a message. You can extend this pattern to perform more complex actions or integrate with other systems in response to events.
</p>

<p><img data-attachment-id="640" data-permalink="https://www.stackextend.com/hybris/use-events-in-sap-hybris/attachment/events-overview-in-hybris/" 
data-orig-file="https://i0.wp.com/www.stackextend.com/wp-content/uploads/2018/03/events-overview-in-hybris.png?fit=717%2C220&amp;ssl=1" 
data-orig-size="717,220" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Events overview in Hybris" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/www.stackextend.com/wp-content/uploads/2018/03/events-overview-in-hybris.png?fit=300%2C92&amp;ssl=1" data-large-file="https://i0.wp.com/www.stackextend.com/wp-content/uploads/2018/03/events-overview-in-hybris.png?fit=717%2C220&amp;ssl=1" decoding="async" class="aligncenter size-full wp-image-640" src="https://i0.wp.com/www.stackextend.com/wp-content/uploads/2018/03/events-overview-in-hybris.png?resize=717%2C220&amp;ssl=1" alt="Events overview in Hybris" width="717" height="220" srcset="https://i0.wp.com/www.stackextend.com/wp-content/uploads/2018/03/events-overview-in-hybris.png?w=717&amp;ssl=1 717w, https://i0.wp.com/www.stackextend.com/wp-content/uploads/2018/03/events-overview-in-hybris.png?resize=300%2C92&amp;ssl=1 300w" sizes="(max-width: 717px) 100vw, 717px"></p>

<h2>
Use events in SAP Hybris
</h2>

<p>

Events are used in Hybris to play tasks that are :
</p><p>

Low priority task.
</p><p>
Task takes long time to run.
</p><p>
Task to be run in a separated thread from the main thread.
</p><p>
For example : send emails, persist logging data, save audit data…
</p><p>
This is a amplified overview of how the events mechanism work in Hybris.
</p><p>
Events overview in Hybris
</p><p>
EventService : Publish event using publishEvent(event) method.
</p><p>
EventListener : Receive event and run logic defined inside onEvent(event) method.
</p><p>
Event : Hold the necessary data to be passed to the EventListener.
</p><p>
In this article, I will show you how to use events in Hybris (create, publish and consume).
</p><p>
2. Implementation
</p><p>
2.1. Create Event
</p><p>
First create a class extends AbstractEvent, that will hold all the data to be passed to the EventListener.
</p><pre>
package com.stackextend.training.core.event;

import de.hybris.platform.servicelayer.event.events.AbstractEvent;

public class HelloWorldEvent extends AbstractEvent {

    private String fullName;

    public HelloWorldEvent(String fullName) {
        this.fullName = fullName;
    }

    public String getFullName() {
        return fullName;
    }
}
</pre><p>
2.2. Create EventListener
</p><p>
Create a HelloWorldEventListener extends AbstractEventListener, and add business logic inside the onEvent(event) method.
</p><pre>
package com.stackextend.training.core.event.listener;

import com.stackextend.training.core.event.HelloWorldEvent;
import de.hybris.platform.servicelayer.event.impl.AbstractEventListener;

public class HelloWorldEventListener extends AbstractEventListener<HelloWorldEvent> {

    @Override
    protected void onEvent(HelloWorldEvent helloWorldEvent) {

        String fullName = helloWorldEvent.getFullName();

        System.out.println("Hello " + fullName);
    }

}
</pre><p>
Register the HelloWorldEventListener as a Spring bean.
</p><code>

...\hybris\bin\custom\training\trainingcore\resources\trainingcore-spring.xml
</p><p>
bean id="helloWorldEventListener"
	  class="com.stackextend.training.core.event.listener.HelloWorldEventListener"
	  parent="abstractSiteEventListener"
</code><p>
2.3. Publish Event
</p><p>
Publishing the event is simple, you need just to call the eventService.publishEvent(event) with an instance of HelloWorldEvent.
</p><pre>
@Autowired
private EventService eventService;

// create HelloWorldEvent instance
HelloWorldEvent event = new HelloWorldEvent("Mouad EL Fakir");

// Publish the event
eventService.publishEvent(event);
</pre>
<pre>
import de.hybris.platform.servicelayer.event.EventService
import com.stackextend.training.core.event.HelloWorldEvent

// retrieve beans from Spring context
EventService eventService = spring.getBean("eventService")

// do business logic
HelloWorldEvent event = new HelloWorldEvent("Mouad EL Fakir");
eventService.publishEvent(event);

// return result
return "OK"
</pre>

